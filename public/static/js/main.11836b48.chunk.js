(this["webpackJsonpcar-app"]=this["webpackJsonpcar-app"]||[]).push([[0],{142:function(e,t,a){e.exports=a(285)},263:function(e,t){},284:function(e,t,a){},285:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(35),s=a.n(i),o=a(20),c=a(9),l=a(10),u=a(12),p=a(11),m=a(15),d=a(23),h=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={expand:!1},e.toggleExpand=function(){e.setState({expand:!e.state.expand})},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("img",{className:"user-preview",src:this.props.user.imgUrl,alt:this.props.user.username+"img",onClick:this.toggleExpand}),r.a.createElement("div",{className:"user-preview-expand flex column justify-around ".concat(this.state.expand?"open":"")},r.a.createElement("button",{className:"styled-button logout",onClick:function(){e.props.logout(),e.props.closemainNavbar()}},"Logout"))))}}]),a}(n.Component),f=a(4),v=a.n(f),g=a(7),y=a(134),b=a.n(y).a.create({withCredentials:!0}),E=function(e,t){return j(e,"GET",t)},w=function(e,t){return j(e,"POST",t)},O=function(e,t){return j(e,"PUT",t)},D=function(e,t){return j(e,"DELETE",t)};function j(e){return k.apply(this,arguments)}function k(){return(k=Object(g.a)(v.a.mark((function e(t){var a,n,r,i=arguments;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.length>1&&void 0!==i[1]?i[1]:"get",n=i.length>2&&void 0!==i[2]?i[2]:null,e.prev=2,e.next=5,b({url:"".concat("/api/").concat(t),method:a,data:n});case 5:return r=e.sent,e.abrupt("return",r.data);case 9:throw e.prev=9,e.t0=e.catch(2),console.log("Had Issues ".concat(a,"ing to the backend, endpoint: ").concat(t,", with data: ").concat(n)),console.dir(e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}var x={query:function(){return T.apply(this,arguments)},getById:function(e){return N.apply(this,arguments)},remove:function(e){return D("trip/".concat(e))},save:function(e){return e._id?O("trip/".concat(e._id),e):w("trip",e)}};function T(){return(T=Object(g.a)(v.a.mark((function e(){var t,a,n=arguments;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{name:""},a="?search=".concat(t.name),e.abrupt("return",E("trip".concat(a)));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return(N=Object(g.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E("trip/".concat(t),t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t){return function(){var a=Object(g.a)(v.a.mark((function a(n){var r;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,r={},!t){a.next=10;break}return n({type:"SET_LOADER"}),a.next=6,new Promise((function(t,a){setTimeout(Object(g.a)(v.a.mark((function a(){var n;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,x.getById(e);case 2:n=a.sent,t(n);case 4:case"end":return a.stop()}}),a)}))),3500)}));case 6:r=a.sent,n({type:"SET_TRIP",trip:r}),a.next=14;break;case 10:return a.next=12,x.getById(e);case 12:r=a.sent,n({type:"SET_TRIP",trip:r});case 14:return a.abrupt("return",r);case 17:a.prev=17,a.t0=a.catch(0),console.log(a.t0);case 20:return a.prev=20,n({type:"CLOSE_LOADER"}),a.finish(20);case 23:case"end":return a.stop()}}),a,null,[[0,17,20,23]])})));return function(e){return a.apply(this,arguments)}}()}function M(e){return function(){var t=Object(g.a)(v.a.mark((function t(a){var n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.query(e);case 2:n=t.sent,a({type:"SET_TRIPS",trips:n});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}function C(e){return function(){var t=Object(g.a)(v.a.mark((function t(a){var n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x.save(e);case 3:return n=t.sent,a({type:"EDIT_TRIP",trip:n}),t.abrupt("return",n);case 8:t.prev=8,t.t0=t.catch(0);case 10:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}function I(e,t){return function(a){a({type:"SET_MODAL",cmp:e,props:t})}}function A(){return function(e){e({type:"CLOSE_MODAL"})}}var R={login:function(e){return _.apply(this,arguments)},logout:function(){return H.apply(this,arguments)},signup:function(e){return L.apply(this,arguments)},getUsers:function(){return E("user")},getById:function(e){return E("user/".concat(e))},remove:function(e){return D("user/".concat(e))},update:function(e){return O("user/".concat(e._id),e)}};function _(){return(_=Object(g.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("auth/login",t);case 2:if(!(a=e.sent)){e.next=5;break}return e.abrupt("return",U(a));case 5:return e.abrupt("return",Promise.reject("user not found"+t));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(){return(L=Object(g.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("auth/signup",t);case 2:return a=e.sent,e.abrupt("return",U(a));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(){return(H=Object(g.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("auth/logout");case 2:sessionStorage.clear();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){return sessionStorage.setItem("user",JSON.stringify(e)),e}window.userService=R;var B=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={navBar:"",isNavbarOpen:!1},e.backgroundChanged=function(){var t=e.props.location.pathname.match("/"),a=t&&e.props.location.pathname===t[0];window.pageYOffset>=80||!a?e.setState({navBar:!0}):e.setState({navBar:!1})},e.openMainNavbar=function(){e.setState({isNavbarOpen:!e.state.isNavbarOpen})},e.closemainNavbar=function(){e.setState({isNavbarOpen:!1})},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.location.pathname.match("/");e&&this.props.location.pathname===e[0]||this.backgroundChanged(),window.addEventListener("scroll",this.backgroundChanged)}},{key:"componentDidUpdate",value:function(e,t){this.props.location.pathname!==e.location.pathname&&(this.backgroundChanged(),"/"===this.props.location.pathname&&this.props.resetTrip())}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.backgroundChanged)}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"main-navbar flex justify-between align-center full  "+(this.state.navBar?"navBar-background":"")},r.a.createElement(d.Link,{to:"/",onClick:this.closemainNavbar}," ",r.a.createElement("h1",{className:"logo"},"Trolly")),r.a.createElement("div",{className:"flex justify-between main-navbar-links ".concat(this.state.isNavbarOpen?"mainbar-open":"")},r.a.createElement(d.Link,{to:"/trip",onClick:this.closemainNavbar},"Trips"),r.a.createElement(d.NavLink,{to:"/about",onClick:this.closemainNavbar},"About"),this.props.usersData.loggedInUser?r.a.createElement(h,{closemainNavbar:this.closemainNavbar,openMainNavbar:this.closemainNavbar,logout:this.props.logout,user:this.props.usersData.loggedInUser}):r.a.createElement("div",{onClick:function(){e.props.showModal("login")}},"Login")),r.a.createElement("button",{className:"mobile-hamburger ",onClick:this.openMainNavbar}," \u2630")),r.a.createElement("div",{className:"navbar-screen ".concat(this.state.isNavbarOpen?"screen-open":""),onClick:this.closemainNavbar}))}}]),a}(n.Component),W={showModal:I,logout:function(){return function(){var e=Object(g.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.logout();case 2:t({type:"SET_USER",user:null});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},resetTrip:function(){return function(e){e({type:"SET_TRIP",trip:null})}}},P=Object(m.b)((function(e){return{usersData:e.userReducer}}),W)(Object(o.o)(B));function F(){return r.a.createElement("div",{className:"about-page"},r.a.createElement("div",{className:"about-hero full "},r.a.createElement("h2",null,"We love to travel the world so we made it easy to plan")),r.a.createElement("div",{className:"about-main"},r.a.createElement("div",{className:"about-desc"},r.a.createElement("h3",null,"About Trolly"),r.a.createElement("p",null,"Trolly enables users to quickly and easily explore a destination\u2019s offerings and create personalized sightseeing itineraries by utilizing local expertise and cutting-edge artificial intelligence. Drawing from a database of over 80,000 destinations Trolly makes trip planning easy, intuitive and enjoyable for over 25 million travelers a year."),r.a.createElement("p",null,"We use technologies that allow users to create and edit trip's plans with friends, chat and watch live changes")),r.a.createElement("h3",null,"About Us"),r.a.createElement("div",{className:"flex about-us justify-evenly"},r.a.createElement("div",{className:"flex column"},r.a.createElement("img",{src:"https://res.cloudinary.com/idanrozen/image/upload/v1600889656/opinion-sin-imagen_raxn0y.png",alt:""}),r.a.createElement("p",null,"Junior Developer")),r.a.createElement("div",{className:"flex column"},r.a.createElement("img",{src:"https://res.cloudinary.com/idanrozen/image/upload/v1600889656/opinion-sin-imagen_raxn0y.png",alt:""}),r.a.createElement("p",null,"Junior Developer")),r.a.createElement("div",{className:"flex column"},r.a.createElement("img",{src:"https://res.cloudinary.com/idanrozen/image/upload/v1600889656/opinion-sin-imagen_raxn0y.png",alt:""}),r.a.createElement("p",null,"Junior Developer")))))}var Y=a(17),J=a(3),Q=a(32),q={makeId:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t+=a.charAt(Math.floor(Math.random()*a.length));return t},calculateDays:function(e,t){t=new Date(t),e=new Date(e);var a=t.getTime()-e.getTime();return Math.ceil(a/999/60/60/24)},createMat:function(e,t){for(var a=[],n=0;n<t;n++){a[n]=[];for(var r=0;r<e;r++)a[n][r]={pos:{i:n,j:r}},0===r&&(a[n][r]=Object(J.a)(Object(J.a)({},a[n][r]),{},{col:0}))}return a},getDateDay:function(e){return new Date(e).getDate()},getWeekDay:function(e){var t=new Date(e);return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()]},getTimeDayStr:function(e){var t=new Date(e),a=z(t.getHours()),n=z(t.getMinutes());return"".concat(a,":").concat(n)},getRandomPic:function(){var e=V(0,K.length-1);return K[e]},getRandomInt:V,getIsoTime:function(e){var t=new Date(e);return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toISOString().slice(0,16)},calculateDates:function(e,t,a){var n=new Date(e),r=[{day:n,td:{start:0}}];for(;n.getDate()!==new Date(t).getDate();)n=new Date(n.getTime()+864e5),r.push({day:n,td:""}),a.forEach((function(e){e.start.getDate()===n.getDate()&&e.start.getMonth()===n.getMonth()?r[r.length-1].td=Object(J.a)(Object(J.a)({},r[r.length-1].td),{},{start:e.idx}):e.start<n&&n.setHours(12)<e.end.setHours(11)?r[r.length-1].td=Object(J.a)(Object(J.a)({},r[r.length-1].td),{},{full:e.idx}):e.end.getDate()===n.getDate()&&e.end.getMonth()===n.getMonth()&&(r[r.length-1].td=Object(J.a)(Object(J.a)({},r[r.length-1].td),{},{end:e.idx}))}));return r},getRandomLatLng:function(){var e=[{lat:-23.5475,lng:-46.6361},{lat:13.751330328,lng:100.489664708},{lat:25.105497,lng:121.597366},{lat:21.028511,lng:105.804817},{lat:39.916668,lng:116.383331},{lat:-16.5,lng:-68.15},{lat:27.700769,lng:85.30014},{lat:14.599512,lng:120.984222},{lat:1.29027,lng:103.851959},{lat:6.927079,lng:79.861244},{lat:28.6448,lng:77.216721}];return e[V(0,e.length-1)]},setToHourMinuets:function(e,t,a){var n=new Date(e);return n.setHours(t,a),n.getTime()},getRandomName:function(){var e=["Moshe544","Cochava","Ilanit","Yaron.B","J-Lo","Meni","QueenB","Latifa","Elvis","Yorgan","Matilda","Muki","Puki","Alfonso","Idan","Roi","Stav","Jermi","Fernandinho","Messi","L-James","Yonit","Adam","Eve","Kelly","Steve","Stue","Laquisha","Marisa","Sharon","Eliyahu"];return e[V(0,e.length-1)]}};function z(e){return 1===(e+"").length?"0"+e:e}function V(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1)+e)}var K=["https://images.unsplash.com/photo-1484804959297-65e7c19d7c9f?ixlib=rb-1.2.1","https://images.unsplash.com/photo-1550399504-8953e1a6ac87?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1473496169904-658ba7c44d8a?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=1080&fit=max&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1527004013197-933c4bb611b3?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1480497490787-505ec076689f?ixlib=rb-1.2.1","https://images.unsplash.com/photo-1475066392170-59d55d96fe51?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1477959858617-67f85cf4f1df?ixlib=rb-1.2.1","https://images.unsplash.com/photo-1507272931001-fc06c17e4f43?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1559128010-7c1ad6e1b6a5?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1545579133-99bb5ab189bd?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1519451241324-20b4ea2c4220?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1528181304800-259b08848526?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1524492412937-b28074a5d7da?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1516483638261-f4dbaf036963?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1523906834658-6e24ef2386f9?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1517792844039-e52afb564132?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1499678329028-101435549a4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1535063406830-27dfae54262a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1554357475-accb8a88a330?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1559628233-100c798642d4?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1527095655060-4026c4af2b25?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1583702993462-43615c05ceee?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1505662695181-d4b60363d2a3?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1455459182396-ae46100617cb?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1512453979798-5ea266f8880c?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/flagged/photo-1559717865-a99cac1c95d8?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/flagged/photo-1559717201-fbb671ff56b7?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0"],G=a(43),X=a.n(G);a(82);function $(e){var t=this;return function(a){setTimeout((function(){t.closeMsg()}),3e3),a({type:"SET_MSG",msg:e})}}function Z(){return function(e){e({type:"CLOSE_MSG"})}}var ee=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.msg,a=e.type;return r.a.createElement(r.a.Fragment,null,"input"===a&&r.a.createElement("div",{className:this.props.isShown?"":"hide"},r.a.createElement("small",{className:"error-msg"},r.a.createElement("i",{className:"fas fa-exclamation-circle"}),t)),"invalid-move"===a&&r.a.createElement("div",{className:this.props.isShown?"":"hide"},r.a.createElement("p",{className:"invalid-move"},r.a.createElement("i",{className:"fas fa-exclamation-triangle"}),t)))}}]),a}(n.Component),te={showMsg:$,closeMsg:Z},ae=Object(m.b)((function(e){return{msg:e.msgReducer.msg,isShown:e.msgReducer.isShown,type:e.msgReducer.type}}),te)(ee),ne=a(41),re=a.n(ne),ie=(n.Component,function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={tripName:"",currTrip:{name:"",location:{lat:null,lng:null},startDate:"",endDate:""},currStartDest:Date.now(),destinations:""},e.onSetDestinations=function(t){t.preventDefault();var a=e.state.currStartDest,n=e.state.currTrip;n.name=n.name.toLowerCase(),n.startDate||(n.startDate=a),(!n.endDate||n.endDate<=n.startDate)&&(n.endDate=n.startDate+1e3*Math.pow(60,2)*24),n.id=q.makeId(),e.setState({destinations:[].concat(Object(Q.a)(e.state.destinations),[n]),currTrip:{name:"",location:{lat:null,lng:null},startDate:"",endDate:""},currStartDest:n.endDate})},e.onSaveDestination=function(){var t=Object(g.a)(v.a.mark((function t(a){var n,r;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),e.state.destinations.length){t.next=4;break}return e.props.showMsg({type:"input",msg:"At least one destination must be added"}),t.abrupt("return");case 4:return n={tripName:e.state.tripName,imgUrl:q.getRandomPic(),activities:[],destinations:e.state.destinations},e.props.loggedInUser?n.members=[{id:e.props.loggedInUser._id,username:e.props.loggedInUser.username,imgUrl:e.props.loggedInUser.imgUrl}]:n.members=[],t.next=8,e.props.addTrip(n);case 8:r=t.sent,e.props.history.push("/trip/".concat(r._id,"/tripRoute"));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleAddress=function(t){e.setState({currTrip:Object(J.a)(Object(J.a)({},e.state.currTrip),{},{name:t})})},e.handleSelect=function(){var t=Object(g.a)(v.a.mark((function t(a){var n,r;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(ne.geocodeByAddress)(a);case 2:return n=t.sent,t.next=5,Object(ne.getLatLng)(n[0]);case 5:r=t.sent,e.setState({currTrip:Object(J.a)(Object(J.a)({},e.state.currTrip),{},{location:r,name:a})});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleInput=function(t,a){var n,r;t.target&&"tripName"===t.target.name?e.setState(Object(J.a)(Object(J.a)({},e.state),{},{tripName:t.target.value})):(t.target?(n=t.target.value,r=t.target.name):(n=new Date(t).getTime(),"startDate"===(r=a)&&(n=e.state.currStartDest)),e.setState(Object(J.a)(Object(J.a)({},e.state),{},{currTrip:Object(J.a)(Object(J.a)({},e.state.currTrip),{},Object(Y.a)({},r,n))})))},e.formatDate=function(e){return"".concat(new Date(e).getDate(),"/").concat(new Date(e).getMonth()+1,"/").concat(new Date(e).getFullYear())},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.state.destinations.length&&this.state.destinations[this.state.destinations.length-1].endDate||Date.now(),a=new Date(this.state.currStartDest),n=new Date(this.state.currTrip.endDate||new Date(this.state.currStartDest+1e3+24*Math.pow(60,2)));return r.a.createElement("div",{className:"flex add-destination-form-wraper"},r.a.createElement("form",{className:"flex column add-destination-form",onSubmit:this.onSetDestinations},r.a.createElement("h3",null,"Create your trip"),r.a.createElement("div",{className:"flex column"},r.a.createElement("input",{className:"styled-input",type:"text",name:"tripName",placeholder:"Enter Trip Name",id:"add-dest-name",value:this.state.tripName,required:!0,autocomplete:"off",onChange:this.handleInput})),r.a.createElement("div",{className:"flex column"},r.a.createElement("input",{className:"styled-input",type:"text",name:"name",placeholder:"Enter City Name",id:"add-dest-city",value:this.state.currTrip.name,required:!0,autocomplete:"off",onChange:this.handleInput})),r.a.createElement("div",{className:"flex"},r.a.createElement("div",{className:"flex column"},r.a.createElement("label",{htmlFor:"startdate-dest-input"},"Start"),r.a.createElement(X.a,{minDate:a,id:"startdate-dest-input",name:"startDate",className:"styled-input",required:!0,selected:this.state.destinations.length?t:Date.now(),onChange:function(t){e.handleInput(t,"startDate")}})),r.a.createElement("div",{className:"flex column"},r.a.createElement("label",{htmlFor:"enddate-dest-input"},"End "),r.a.createElement(X.a,{minDate:a,id:"enddate-dest-input",name:"endDate",className:"styled-input",required:!0,selected:n,onChange:function(t){e.handleInput(t,"endDate")}}))),r.a.createElement(ae,null),r.a.createElement("button",{className:"styled-button",onSubmit:this.onSetDestinations},"Add destination"),this.state.destinations.length?r.a.createElement("ol",{className:"trip-list-add-form flex column"},this.state.destinations.map((function(t){return r.a.createElement("li",{key:q.makeId(),className:"flex justify-between"},r.a.createElement("p",null,t.name),r.a.createElement("div",{className:"flex"},r.a.createElement("p",null,e.formatDate(t.startDate))," -",r.a.createElement("p",null,e.formatDate(t.endDate))))}))):"",r.a.createElement("button",{className:"styled-button",onClick:this.onSaveDestination},"Ready To Plan!")),r.a.createElement("div",{className:"add-dest-img-wraper"},r.a.createElement("img",{src:"https://images.unsplash.com/photo-1484804959297-65e7c19d7c9f?ixlib=rb-1.2.1",alt:""})))}}]),a}(n.Component)),se={addTrip:C,showMsg:$,closeMsg:Z},oe=Object(m.b)((function(e){return{loggedInUser:e.userReducer.loggedInUser}}),se)(Object(o.o)(ie)),ce=a(302),le=a(299),ue=a(301),pe=a(292),me=a(293),de=a(294),he=a(295),fe=a(296),ve=a(297),ge=a(298);a(232),a(233);var ye={add:function(e){return Ee.apply(this,arguments)},query:function(e){return be.apply(this,arguments)},remove:function(e){return D("review/".concat(e))}};function be(){return(be=Object(g.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&(a="?tripId=".concat(t.tripId)),e.abrupt("return",E("review".concat(a)));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ee(){return(Ee=Object(g.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.createdAt=Date.now(),e.next=3,w("review",t);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var we={loadReviews:function(e){return function(){var t=Object(g.a)(v.a.mark((function t(a){var n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ye.query(e);case 3:return n=t.sent,a({type:"SET_REVIEWS",reviews:n}),t.abrupt("return",n);case 8:t.prev=8,t.t0=t.catch(0),console.log("ReviewActions: err in loadReviews",t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},addReview:function(e){return Oe.apply(this,arguments)}};function Oe(){return(Oe=Object(g.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.add(t);case 2:return e.abrupt("return",function(){var e=Object(g.a)(v.a.mark((function e(a){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ye.add(t);case 3:n=e.sent,a({type:"REVIEW_ADD",review:n}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("ReviewActions: err in addReview",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var De=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleClick=Object(g.a)(v.a.mark((function t(){var a,n,r,i,s;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=Object(J.a)({},e.props.trip),e.props.loggedInUser&&(a=e.props.trip.members.find((function(t){return t.id===e.props.loggedInUser._id}))),!a){t.next=7;break}return e.props.history.push("/trip/".concat(e.props.trip._id,"/triproute")),t.abrupt("return");case 7:return r=e.props.loggedInUser?e.props.loggedInUser.username:"guest",i=n._id,delete n._id,n.members=[],n.originId=i,n.tripName=n.tripName+" - "+r,t.next=15,e.props.addTrip(n);case 15:s=t.sent,e.props.history.push("/trip/".concat(s._id,"/triproute"));case 17:case"end":return t.stop()}}),t)}))),e.getTripPrice=function(e){return e.reduce((function(e,t){return e+=t.price.amount}),0)},e.getReviewsAvg=function(){try{var t=e.state.reviews.reduce((function(t,a){return e.state.reviews.length?t+=+a.rating:t=0,t}),0);return t?(t/e.state.reviews.length).toFixed(1):0}catch(a){}},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.loadReviews()}},{key:"loadReviews",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.loadReviews({tripId:this.props.trip._id});case 2:(t=e.sent)||(t=[]),this.setState({reviews:t});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.trip,a=e.addClass;if(!t)return r.a.createElement("p",null,"Loading Trip . . .");var n=this.getTripPrice(t.activities),i=q.calculateDays(t.destinations[0].startDate,t.destinations[t.destinations.length-1].endDate),s=this.props.style?this.props.style:"",o=this.getReviewsAvg();return r.a.createElement("div",{style:{pointerEvents:s.pointerEvents?s.pointerEvents:"inherit"},onClick:this.handleClick,className:"trip-preview flex column "+(a||"")},r.a.createElement("div",{className:"img-wraper"},r.a.createElement("img",{src:t.imgUrl,alt:""})),r.a.createElement("div",{className:"trip-preview-details"},r.a.createElement("h3",null,t.tripName),r.a.createElement("div",{className:"flex details-container"},t.createdBy&&r.a.createElement("div",{className:"flex align-center column img-container"},r.a.createElement("img",{className:"user-img",src:t.createdBy.imgUrl,alt:"user-img"}),r.a.createElement("p",null," ",t.createdBy.username)),r.a.createElement("div",{className:"flex justify-between column"},r.a.createElement("p",null,r.a.createElement("i",{className:"fas fa-hourglass-half"}),i," days"),r.a.createElement("p",null,"Est Price: ",r.a.createElement("i",{className:"fas fa-dollar-sign"}),n),r.a.createElement("div",{className:"flex rating-star"},r.a.createElement("img",{src:"https://res.cloudinary.com/idanrozen/image/upload/v1600689776/450716_preview_uyyiz1.png",alt:""}),r.a.createElement("div",{className:"flex justify-between"},o?r.a.createElement("span",null,o," ",r.a.createElement("span",null,"(",this.state.reviews.length," reviews) ")):"(0)")),r.a.createElement("p",null,"Trollied by ".concat(q.getRandomName()," and ").concat(q.getRandomInt(50,220)," others"))))))}}]),a}(n.Component),je={loadReviews:we.loadReviews,addTrip:C,showModal:I},ke=Object(m.b)((function(e){return{reviews:e.reviewReducer.reviews,loggedInUser:e.userReducer.loggedInUser}}),je)(Object(o.o)(De));function xe(e){var t=e.trips;return r.a.createElement(ce.a,{effect:"coverflow",slidesPerView:"auto",navigation:!0,centeredSlides:!0,delay:2500,coverflowEffect:{rotate:30,depth:200},pagination:{clickable:!0}},t.map((function(e,t){return r.a.createElement(le.a,{key:q.makeId()},r.a.createElement(ke,{trip:e,key:e._id,addClass:"slider",img:q.getRandomPic()}))})))}function Te(){return r.a.createElement("div",{className:"flex column align-center user-flow",id:"userFlow"},r.a.createElement("div",{className:"flex align-center"},r.a.createElement("div",null,r.a.createElement("p",{className:"flow-headline"},"Choose a trip"),r.a.createElement("p",{className:"flow-content"},"Choose from one of our amazing planned trips")),r.a.createElement("img",{src:"https://res.cloudinary.com/roidinary/image/upload/v1600869772/undraw_traveling_t8y2_xnd0ne.svg",alt:"choose-travel"})),r.a.createElement("div",{className:"flex align-center"},r.a.createElement("img",{src:"https://res.cloudinary.com/roidinary/image/upload/v1600869761/undraw_travel_plans_li01_k6igg6.svg",alt:""}),r.a.createElement("div",{className:"flow-text"},r.a.createElement("p",{className:"flow-headline"},"Personalize it"),r.a.createElement("p",{className:"flow-content"},"Personalize ",r.a.createElement("span",{style:{fontWeight:"bold"}},"destinations "),"on Route and ",r.a.createElement("span",{style:{fontWeight:"bold"}},"activities "),"on Assembly "))),r.a.createElement("div",{className:"flex align-center"},r.a.createElement("div",null,r.a.createElement("p",{className:"flow-headline"},"Add your friends"),r.a.createElement("p",{className:"flow-content"},"invite friends to plan together on the same document")),r.a.createElement("img",{src:"https://res.cloudinary.com/roidinary/image/upload/v1600870015/undraw_social_friends_nsbv_c9ovrw.svg",alt:""})))}ue.a.use([pe.a,me.a,de.a,he.a,fe.a,ve.a,ge.a]);var Ne=a(77),Se=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={trips:""},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.loadTrips();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.props.trips[0]?r.a.createElement("div",{className:"home-page  main-container "},r.a.createElement("div",{className:"home-page-hero full"},r.a.createElement("div",{className:"description-section"},r.a.createElement("h3",null,"Explore planned trips of professional travelers"),r.a.createElement("h3",null,"and personalize them"),r.a.createElement(Ne.HashLink,{smooth:!0,to:"#userFlow",scroll:function(e){return e.scrollIntoView({behavior:"smooth",block:"center"})}},r.a.createElement("button",{className:"styled-button"}," Get Started")))),r.a.createElement("div",{className:"main-home-page full"},r.a.createElement("div",{className:"flow-container"},r.a.createElement(Te,{id:"userFlow"}),r.a.createElement(Ne.HashLink,{smooth:!0,to:"#top-rated-trips",scroll:function(e){return e.scrollIntoView({behavior:"smooth",block:"nearest"})}},r.a.createElement("button",{className:"styled-button"}," Let's Trolly!"))),r.a.createElement("div",{className:"slideShow-area",id:"top-rated-trips"},r.a.createElement("div",{id:"top-rated-trips"}),r.a.createElement("h2",{className:""},"Top rated planned trips"),r.a.createElement("section",{className:"slideShow"},r.a.createElement(xe,{trips:this.props.trips.slice(0,4)}),r.a.createElement(Ne.HashLink,{to:"/trip"},r.a.createElement("button",{className:"styled-button to-trip-list"}," Show me more")))),r.a.createElement(oe,null))):r.a.createElement("p",null," ")}}]),a}(n.Component),Me={loadTrips:M},Ce=Object(m.b)((function(e){return{trips:e.tripReducer.trips}}),Me)(Se),Ie=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.mostOccDests;return r.a.createElement("div",{className:"trip-filter flex",style:this.props.style},r.a.createElement("img",{src:"https://res.cloudinary.com/idanrozen/image/upload/v1601236322/search_ejr7qx.png",alt:""}),r.a.createElement("input",{autoComplete:"off",placeholder:"Search destination",className:"styled-input",name:"name",onChange:this.props.handleInput,list:"dest-filter"}),r.a.createElement("datalist",{onChange:this.props.handleInput,id:"dest-filter"},e.map((function(e){return r.a.createElement("option",{key:q.makeId(),value:"".concat(e)})}))))}}]),a}(n.Component),Ae=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.trips.length){e.next=3;break}return e.next=3,this.props.loadTrips();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.trips,a=e.addClass,n=e.showModal;return t.length?r.a.createElement("div",{className:"trip-list trips-container "+(a||"")},t.length?t.map((function(e,t){return r.a.createElement(ke,{key:e._id,trip:e,showModal:n,addClass:a,img:q.getRandomPic()})})):r.a.createElement(ke,{key:t._id,trip:t,addClass:a,img:q.getRandomPic()})):r.a.createElement("p",null,"Loading Trips . . . ")}}]),a}(n.Component),Re={loadTrips:M},_e=Object(m.b)((function(e){return{trips:e.tripReducer.trips}}),Re)(Ae),Le=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={filterBy:{name:""}},e.getMostOccDests=function(){var t=e.props.trips,a=[];t.forEach((function(e){a=a.concat(e.destinations)}));var n=a.reduce((function(e,t){return e[t.name]=e[t.name]?e[t.name]+1:1,e}),{}),r=Object.entries(n);return r.sort((function(e,t){return t[1]-e[1]})),r.slice(0,5).map((function(e){return e[0][0].toLocaleUpperCase()+e[0].substring(1)}))},e.handleInput=function(t){var a=t.target,n=a.name,r=a.value;e.setState({filterBy:Object(J.a)(Object(J.a)({},e.state.filterBy),{},Object(Y.a)({},n,r))},(function(){e.props.loadTrips(e.state.filterBy)}))},e.getTripsForDisplay=function(){return e.props.trips.filter((function(t){return t.destinations[0].name.includes(e.state.name)}))},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.loadTrips(this.state.filterBy)}},{key:"render",value:function(){var e=this.props.trips,t=this.getMostOccDests();return this.getMostOccDests(),r.a.createElement("div",{className:"trip-stock"},r.a.createElement("h2",null,"All Trips plans"),r.a.createElement(Ie,{mostOccDests:t,handleInput:this.handleInput,onsetFilter:this.onsetFilter}),r.a.createElement(_e,{showModal:this.props.showModal,trips:e}))}}]),a}(n.Component),He={loadTrips:M,showModal:I},Ue=Object(m.b)((function(e){return{trips:e.tripReducer.trips}}),He)(Le),Be=a(33),We=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={msg:""},e.onSubmit=function(){var t=Object(g.a)(v.a.mark((function t(a){var n,r,i,s;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),n=a.target,r=n.email,i=n.password,s={email:r.value,password:i.value},t.next=5,e.props.handleForm(s);case 5:t.sent?e.props.closeModal():e.setState({msg:"wrong username or password"});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("form",{className:"login-form flex align-center justify-center column",onSubmit:this.onSubmit},r.a.createElement("input",{className:"styled-input",type:"email",placeholder:"email",name:"email"}),r.a.createElement("input",{className:"styled-input",type:"password",placeholder:"password",name:"password"}),r.a.createElement("button",{className:"styled-button"},"Login"),r.a.createElement("p",null,"not a user? please ",r.a.createElement("span",{onClick:function(){return e.props.handleClick("signup")}},"sign up")),this.state.msg&&r.a.createElement("p",null,this.state.msg))}}]),a}(r.a.Component),Pe=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={username:"",email:"",password:"",imgUrl:"https://res.cloudinary.com/roidinary/image/upload/v1600790523/Untitled-1_xumtnf.jpg"},e.handleChange=function(t){var a=t.target,n=a.value,r=a.name;e.setState(Object(J.a)(Object(J.a)({},e.state),{},Object(Y.a)({},r,n)))},e.onSubmit=function(t){t.preventDefault(),e.props.handleForm(e.state,"signup",e.props.tripToRed),e.props.closeModal()},e}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("form",{onSubmit:this.onSubmit,className:"flex column align-center"},r.a.createElement("input",{type:"text",name:"username",value:this.state.username,placeholder:"Username",onChange:this.handleChange,className:"styled-input"}),r.a.createElement("input",{type:"email",name:"email",value:this.state.email,placeholder:"email",onChange:this.handleChange,className:"styled-input"}),r.a.createElement("input",{type:"password",name:"password",value:this.state.password,placeholder:"password",onChange:this.handleChange,className:"styled-input"}),r.a.createElement("button",{className:"styled-button"},"Sign Up"))}}]),a}(r.a.Component),Fe=a(137),Ye=a.n(Fe),Je=function(){var e;return{setup:function(){e=Ye()("")},on:function(t,a){e.on(t,a)},off:function(t,a){e.off(t,a)},emit:function(t,a){e.emit(t,a)},terminate:function(){e=null}}}();var Qe=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={login:!0},e.handleForm=function(){var t=Object(g.a)(v.a.mark((function t(a,n,r){var i,s,o,c,l;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("signup"!==n){t.next=19;break}if(!r){t.next=14;break}return t.next=4,Promise.all([e.props.loadTrip(r),e.props.signup(a)]);case 4:return i=t.sent,s=Object(Be.a)(i,2),o=s[0],c=s[1],o.members.push({username:c.username,imgUrl:c.imgUrl,id:c._id}),t.next=11,e.props.addTrip(o);case 11:return Je.emit("tripToUpdate",o),e.props.closeModal(),t.abrupt("return",c);case 14:return t.next=16,e.props.signup(a);case 16:return t.abrupt("return",t.sent);case 19:return t.next=21,e.props.login(a);case 21:if(l=t.sent){t.next=24;break}return t.abrupt("return");case 24:return t.abrupt("return",l);case 25:case"end":return t.stop()}}),t)})));return function(e,a,n){return t.apply(this,arguments)}}(),e.closeModal=function(){e.props.closeModal()},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.page!==this.state.login&&this.setState({login:this.props.page})}},{key:"componentDidUpdate",value:function(){this.props.page!==this.state.login&&this.setState({login:this.props.page})}},{key:"render",value:function(){var e=this.props.tripId;return this.state.login?r.a.createElement(We,{handleForm:this.handleForm,handleClick:this.props.handleClick,closeModal:this.closeModal}):r.a.createElement(Pe,{handleForm:this.handleForm,handleClick:this.props.handleClick,closeModal:this.closeModal,tripId:this.props.tripId,tripToRed:e})}}]),a}(n.Component),qe={signup:function(e){return function(){var t=Object(g.a)(v.a.mark((function t(a){var n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.signup(e);case 2:return n=t.sent,a({type:"SET_USER",user:n}),t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},login:function(e){return function(){var t=Object(g.a)(v.a.mark((function t(a){var n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,R.login(e);case 3:return n=t.sent,a({type:"SET_USER",user:n}),t.abrupt("return",n);case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0,"actionsuser"),a({type:"LOGIN_PROBLEM"});case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},closeModal:A,showModal:I,loadTrip:S,addTrip:C},ze=Object(m.b)((function(e){return{}}),qe)(Qe),Ve=a(103);var Ke={on:function(e,t){var a=function(e){var a=e.detail;t(a)};return window.addEventListener(e,a),function(){window.removeEventListener(e,a)}},emit:function(e,t){window.dispatchEvent(new CustomEvent(e,{detail:t}))}},Ge=a(303),Xe="activitie",$e="destination";function Ze(e){var t=e.act,a=e.onRemoveAct,n=(e.onEdit,e.destinations),i=e.onOpenDetails,s=Object(Ge.a)({item:{type:Xe,id:t.id},collect:function(e){return{isDragging:!!e.isDragging()}}}),o=Object(Be.a)(s,2),c=o[0].isDragging,l=o[1],u=0===t.col?"first-col":"",p=t.literalDay?"literal-day":"",m=c?"is-drag":"",d=1===t.duration?"len-one":"",h=n.findIndex((function(e){return t.destination===e.name}));return r.a.createElement("div",{ref:l,className:"activity-prev-assembly activity-assembly ".concat(d," ").concat(p," ").concat(u," ").concat(m),style:{gridRow:"".concat(t.row+1||"auto","/span ").concat(t.duration)},key:q.makeId()},r.a.createElement("div",{className:"dest-color dest-"+h}),r.a.createElement("div",{className:"activity-name-container"},r.a.createElement("h5",null,t.name)),r.a.createElement("div",{className:"activity-assembly-details column"},r.a.createElement("div",{className:"activity-assembly-controls flex"},r.a.createElement("button",{onClick:function(){i(t)}},r.a.createElement("i",{className:"fas fa-info"})),r.a.createElement("button",{onClick:function(){a(t.id)},className:"delete-activity "},r.a.createElement("i",{className:"fas fa-trash"})))))}var et=a(304);function tt(e){var t=e.act,a=(e.getRowIdx,e.onDragMove),n=Object(et.a)({accept:Xe,drop:function(e,n){a(t,e.id)},collect:function(e){return{isOver:!!e.isOver()}}}),i=Object(Be.a)(n,2),s=i[0].isOver,o=i[1],c=0===t.col?"first-col":"",l=t.literalDay?"literal-day":"",u=s?"is-over":"";return r.a.createElement(r.a.Fragment,null,t.literalDay&&r.a.createElement("div",{className:"activity-prev-assembly empty-assembly ".concat(c," ").concat(l,"  ").concat(u),style:{gridRow:"".concat("auto","/span 1")},key:q.makeId()},t.date),!t.literalDay&&r.a.createElement("div",{ref:o,className:"activity-prev-assembly empty-assembly ".concat(c," ").concat(l,"  ").concat(u),style:{gridRow:"".concat("auto","/span 1")},key:q.makeId()},t.date))}function at(e){var t=e.day,a=e.getRowIdx,n=e.onRemoveAct,i=e.onEdit,s=e.destinations,o=e.onDragMove,c=e.onOpenDetails;var l=function(e){for(var t=[],a=0;a<35;)t.push(e[a]),a+=e[a].id?e[a].duration:1;return t}(t);return r.a.createElement("div",{className:"day-list-assembly"},l.map((function(e){return e.id?r.a.createElement(Ze,{destinations:s,onEdit:i,onRemoveAct:n,getRowIdx:a,key:q.makeId(),act:e,onOpenDetails:c}):r.a.createElement(tt,{destinations:s,onEdit:i,onRemoveAct:n,getRowIdx:a,key:q.makeId(),act:e,onDragMove:o})})))}function nt(){return r.a.createElement("div",{className:"time-line-assembly"},function(){for(var e=[],t=0;t<35;t++){var a=r.a.createElement("div",{key:q.makeId(),className:"time-assembly"},t%2===0&&r.a.createElement("span",null,"".concat(7+t/2,":00")));e.push(a)}return e}())}function rt(e){var t=e.dest,a=(e.updateFreeDays,e.freeDays,e.destinations.findIndex((function(e){return e.name===t.name}))),n=t.duration?"":"none";return r.a.createElement("div",{className:"dest-name-preview dest-head-".concat(a," "),style:{gridColumn:"span ".concat(t.duration),display:n}},t.name)}function it(e){var t=e.destinations,a=e.allDestinations,n=e.daysCount;return t.sort((function(e,t){return e.time.startDate-t.time.startDate})),r.a.createElement("div",{className:"destinations-header",style:{gridTemplateColumns:"repeat(".concat(2*n,", minmax(25px, 1fr))")}},t.map((function(e,t){return r.a.createElement(rt,{destinations:a,idx:t,key:q.makeId(),dest:e})})))}var st=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={activities:null,weekMat:null,page:0,startDate:null,endDate:null,tripLength:"",actsToDisplay:null,minDestinations:null,daysCount:7},e.setChosenDay=function(){var t=Object(g.a)(v.a.mark((function t(a){var n,r,i;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.getLinearTripDays().map((function(e){return new Date(e).toLocaleDateString()})),r=a.day.toLocaleDateString(),i=n.findIndex((function(e){return e===r})),e.props.openSideBar(),e.initiateAssembly(1,i);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.initiateAssembly=Object(g.a)(v.a.mark((function t(){var a,n,r,i,s,o,c,l,u,p,m=arguments;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=m.length>0&&void 0!==m[0]?m[0]:7,n=m.length>1&&void 0!==m[1]?m[1]:0,r=e.props.trip,i=r.destinations,s=r.activities,o=window.window.innerWidth,7===a&&(o<=1300&&(a=6),o<=1e3&&(a=5),o<=850&&(a=4),o<=700&&(a=3),o<=530&&(a=2)),u=[i[0].startDate,i[i.length-1].endDate],c=u[0],l=u[1],p=q.calculateDays(c,l),t.next=11,e.setState(Object(J.a)(Object(J.a)({},e.state),{},{tripLength:p,startDate:c,endDate:l,activities:s,daysCount:a,page:n}),(function(){return e.loadWeekMat()}));case 11:return t.next=13,e.setState({minDestinations:e.getMinDestinations()});case 13:case"end":return t.stop()}}),t)}))),e.loadWeekMat=function(){for(var t=e.props.trip.activities,a=e.state,n=a.page,r=a.daysCount,i=e.mapActsToDays(t).slice(n*r,n*r+r),s=i[0][1][0].at,o=q.getDateDay(s),c=q.createMat(e.state.daysCount,35),l=0,u=i[0][0],p=0;p<i.length;p++){var m=void 0,d=void 0,h=[i[p][0],i[p][1]];d=h[1],u>(m=h[0])&&(m+=e.getDaysInMonth(s)),u=m,l=m-o,d.forEach((function(t){if(!t.freeDay){var a=e.getRowIdx(t.at);t=Object(J.a)(Object(J.a)({},t),{},{col:l,row:a}),c[a][l]=t}}))}c=e.showDaysName(s,c),e.setState({weekMat:c,actsToDisplay:i})},e.onRemoveAct=function(t){e.props.showModal("removeActivity",{removeAct:e.removeAct,actId:t})},e.removeAct=function(){var t=Object(g.a)(v.a.mark((function t(a){var n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.activities,t.next=3,n.filter((function(e){return e.id!==a}));case 3:return n=t.sent,t.next=6,e.props.updateTripAct(n);case 6:return t.next=8,e.setState({activities:n});case 8:return t.next=10,e.props.closeModal();case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.isOccTimeSlot=function(t){for(var a=e.state.activities,n=t.at,r=n+30*t.duration*60*1e3,i=0;i<a.length;i++){var s=a[i],o=s.at,c=s.at+30*s.duration*60*1e3;if((!t.id||t.id!==s.id)&&(n>o&&n<c||r>o&&r<c||o>n&&o<r||c>n&&c<r))return!0}return!1},e.mapActsToDays=function(){var t=e.props.trip.activities;t.sort((function(e,t){return e.at-t.at}));var a=t.reduce((function(e,t){var a=q.getDateDay(t.at);return e[a]||(e[a]=[]),e[a].push(t),e}),{});return a=e.sortDateMap(a)},e.getCol=function(e,t){var a;return a=t,e.map((function(e){return e[a]}))},e.onEdit=function(t){e.props.showModal("editActivity",{saveAct:e.saveAct,act:t,isOccTimeSlot:e.isOccTimeSlot,destinations:e.props.trip.destinations})},e.onOpenDetails=function(t){e.props.showModal("activityDetails",{saveAct:e.saveAct,act:t,isOccTimeSlot:e.isOccTimeSlot,destinations:e.props.trip.destinations})},e.onDragMove=function(t,a){var n=t.pos,r=e.state.activities.find((function(e){return e.id===a})),i=e.props.trip.destinations.find((function(e){return e.name===r.destination})),s=e.getTimeFromIdx(n),o=q.setToHourMinuets(i.startDate,6,0),c=q.setToHourMinuets(i.endDate,23,59);if(s<o||s>c)e.props.showMsg({type:"invalid-move",msg:"Cannot move activities to another destination!"});else if(s){var l=Object(J.a)(Object(J.a)({},r),{},{at:s});e.isOccTimeSlot(l)?e.props.showMsg({type:"invalid-move",msg:"You aleardy have plans for that date! please choose a different one."}):(r.at=s,e.saveAct(r))}},e.getTimeFromIdx=function(t){var a=t.i,n=t.j,r=e.state.page,i=e.getLinearTripDays();if(n+r*e.state.daysCount>=i.length)return!1;var s=new Date(i[n+r*e.state.daysCount]);return a%2!==0?s.setHours(7+(a-1)/2,0):s.setHours(6+a/2,30),s.getTime()},e.saveAct=function(t){var a=e.state.activities;t.id?a=a.map((function(e){return e.id===t.id?t:e})):(t.id=q.makeId(),a.push(t)),e.props.closeModal(),e.props.updateTripAct(a),e.setState({activities:a}),e.loadWeekMat()},e.getWeekDests=function(){var t=e.state,a=t.page,n=t.daysCount,r=e.props.trip.destinations,i=e.getLinearTripDays(),s=i[a*n],o=a*n;o+n-1>=i.length?o=i.length-1:o+=n-1;var c=i[o];return s=new Date(s),c=new Date(c),s=q.setToHourMinuets(s,7,0),c=q.setToHourMinuets(c,23,59),r.filter((function(e){var t=new Date(e.startDate),a=new Date(e.endDate);return t=q.setToHourMinuets(t,10,0),a=q.setToHourMinuets(a,10,0),t>=s&&t<=c||a>=s&&a<=c}))},e.getMinDestinations=function(){for(var t=e.getWeekDests(),a=[],n=e.mapDestsToHeaderLength(),r=Object.keys(n),i=Object.values(n),s=function(e){var n=t.find((function(t){return t.name===r[e]}));a.push({name:r[e],duration:i[e],time:n})},o=0;o<r.length;o++)s(o);return a},e.mapDestsToHeaderLength=function(){var t,a,n=e.props.trip,r=e.state.page,i=e.props.trip.destinations,s=n.destinations[0].startDate,o=n.destinations[n.destinations.length-1].endDate,c=n.destinations.map((function(e,t){return{start:new Date(e.startDate),end:new Date(e.endDate),idx:t}}));return q.calculateDates(s,o,c).slice(r*e.state.daysCount,r*e.state.daysCount+e.state.daysCount).reduce((function(e,n,r){var s=n.td;return s.full||0===s.full?(a=i[s.full],e[t=a.name]=e[t]?e[t]+2:2):!s.start&&0!==s.start||s.end||0===s.end?((s.start||0===s.start)&&(a=i[s.start],e[t=a.name]=e[t]?e[t]+1:1),(s.end||0===s.end)&&(a=i[s.end],e[t=a.name]=e[t]?e[t]+1:1)):(a=i[s.start],e[t=a.name]=e[t]?e[t]+2:2),e}),{})},e.getLinearTripDays=function(){for(var t=[],a=e.state,n=a.startDate,r=a.tripLength,i=0;i<r;i++)t.push(n+24*i*60*60*1e3);return t},e.getDestsWithActs=function(t,a){return t=t.filter((function(t){return e.isActInDests(t,a)}))},e.getRowIdx=function(e){var t=new Date(e),a=t.getHours();return 0===t.getMinutes()?2*(a-6)-1:2*(a-6)},e.onTogglePage=function(){var t=Object(g.a)(v.a.mark((function t(a){var n,r,i,s,o;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,r=n.tripLength,i=n.page,s=Math.ceil(r/e.state.daysCount),o="next"===a?(i+1)%s:i-1<0?s-1:i-1,t.next=5,e.setState({page:o});case 5:return t.next=7,e.loadWeekMat();case 7:e.setState({minDestinations:e.getMinDestinations()});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getDayNumOfAct=function(e){return e.reduce((function(e,t){return e+=t.id?1:0}),0)},e.getTwoDig=function(e){var t=e+"";return 1===t.length?"0"+t:t},e.setFullAssembly=function(){e.initiateAssembly(7,0),e.props.setDestsMarkers()},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t,a=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Ke.on("markDay",(function(e){a.setChosenDay(e)})),this.removeBus=t,this.initiateAssembly();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e,t){e.trip!==this.props.trip&&this.initiateAssembly(this.state.daysCount,this.state.page)}},{key:"componentWillUnmount",value:function(){this.removeBus()}},{key:"showDaysName",value:function(e,t){for(var a=0;a<this.state.daysCount;a++){var n=e+24*a*Math.pow(60,2)*1e3,r=new Date(n),i=("0"+r.getDate()).slice(-2)+"/"+("0"+(r.getMonth()+1)).slice(-2)+"/"+r.getFullYear();t[0][a]={duration:1,literalDay:q.getWeekDay(n),date:i,time:r}}return t}},{key:"sortDateMap",value:function(e){var t=[];for(var a in e)t.push([+a,e[a]]);for(var n=this.getLinearTripDays(),r=function(e){var a=q.getDateDay(n[e]);t.find((function(e){return e[0]===a}))||t.push([a,[{at:n[e],freeDay:!0}]])},i=0;i<n.length;i++)r(i);return t.sort((function(e,t){return e[1][0].at-t[1][0].at})),t}},{key:"getDaysInMonth",value:function(e){var t=new Date(e),a=[t.getMonth(),t.getFullYear()];return new Date(a[1],a[0]+1,0).getDate()}},{key:"isActInDests",value:function(e,t){var a,n=Object(Ve.a)(t);try{for(n.s();!(a=n.n()).done;){var r,i=a.value[1],s=Object(Ve.a)(i);try{for(s.s();!(r=s.n()).done;){if(r.value.destination===e.name)return!0}}catch(o){s.e(o)}finally{s.f()}}}catch(o){n.e(o)}finally{n.f()}return!1}},{key:"renderDayActivities",value:function(e){for(var t=[],a=0;a<e[0].length;a++){var n=this.getCol(e,a);t.push(r.a.createElement(at,{onDragMove:this.onDragMove,getTimeFromIdx:this.getTimeFromIdx,destinations:this.props.trip.destinations,onEdit:this.onEdit,onOpenDetails:this.onOpenDetails,onRemoveAct:this.onRemoveAct,getRowIdx:this.getRowIdx,key:q.makeId(),day:n}))}return t}},{key:"render",value:function(){var e=this,t=this.state,a=t.weekMat,n=t.minDestinations,i=t.daysCount,s=this.props.trip.destinations;if(!a||!n)return r.a.createElement("div",null,"Loading...");var o=this.renderDayActivities(a);return this.mapDestsToHeaderLength(),r.a.createElement("div",{className:"assembly-container"},1!==i&&r.a.createElement("div",{className:"destinations-header-wraper"},r.a.createElement("div",{className:"toggle-page prev",onClick:function(){return e.onTogglePage("prev")}},r.a.createElement("i",{className:"fas fa-chevron-circle-left"})),r.a.createElement("div",{className:"toggle-page next",onClick:function(){return e.onTogglePage("next")}},r.a.createElement("i",{className:"fas fa-chevron-circle-right"}))),1===i&&r.a.createElement("section",{className:"full-assembly "},r.a.createElement("button",{className:"styled-button",onClick:this.setFullAssembly},"Back")),r.a.createElement(it,{daysCount:i,allDestinations:s,destinations:n}),r.a.createElement("div",{className:"trip-assembly-main full",style:{gridTemplateColumns:"repeat(".concat(i,", minmax(70px, 1fr))")}},r.a.createElement(nt,null),o),r.a.createElement("button",{className:"editActivity styled-button",onClick:function(){return e.props.showModal("editActivity",{saveAct:e.saveAct,isOccTimeSlot:e.isOccTimeSlot,act:null,destinations:e.props.trip.destinations})}},"add activity"))}}]),a}(n.Component);function ot(e){var t=e.member.imgUrl||"https://res.cloudinary.com/roidinary/image/upload/v1600790523/Untitled-1_xumtnf.jpg";return r.a.createElement("div",{className:"member-preview"},r.a.createElement("img",{className:"image-preview",src:t,alt:"img Preview"}),r.a.createElement("div",{className:"is-active-circle"}))}var ct=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={addDestOpen:!1,destination:{name:"",days:"",location:null}},e.handleAddress=function(t){e.setState({destination:Object(J.a)(Object(J.a)({},e.state.destination),{},{name:t})})},e.handleSelect=function(){var t=Object(g.a)(v.a.mark((function t(a){var n,r;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(ne.geocodeByAddress)(a);case 3:return n=t.sent,t.next=6,Object(ne.getLatLng)(n[0]);case 6:r=t.sent,e.setState({destination:Object(J.a)(Object(J.a)({},e.state.destination),{},{location:r,name:a})}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0,"err");case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}(),e.handleChange=function(t){var a=t.target,n=a.name,r=a.value;e.setState({destination:Object(J.a)(Object(J.a)({},e.state.destination),{},Object(Y.a)({},n,r))})},e.onSubmit=function(t){t.preventDefault(),e.toggleAddDestination(),e.props.addDestination(e.state.destination),e.setState({destination:{name:"",days:"",location:null}})},e.toggleAddDestination=function(){e.setState({addDestOpen:!e.state.addDestOpen})},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.setState({destination:{name:"",days:"",location:null}})}},{key:"render",value:function(){var e=this.state.addDestOpen?"form-open":"";return r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-plus add-destination-button",onClick:this.toggleAddDestination}),r.a.createElement("div",{className:"add-destination column ".concat(e)},r.a.createElement("div",{className:"styled-header"},"Add destination"),r.a.createElement("form",{onSubmit:this.onSubmit,className:"add-destination-form  "},r.a.createElement("input",{type:"text",placeholder:"Enter destination",name:"name",value:this.state.destination.name,onChange:this.handleChange}),r.a.createElement("input",{type:"number",placeholder:"Number of days",name:"days",value:this.state.destination.days,onChange:this.handleChange}),r.a.createElement("button",{className:"styled-button"},"Add!")),r.a.createElement("div",{className:"add-destination-footer"})))}}]),a}(r.a.Component);function lt(e){var t=e.dates,a=e.showDay;return r.a.createElement("tr",{key:q.makeId()},t.map((function(e,t){return r.a.createElement("td",{onClick:function(){return a(e)},className:"".concat(e.td?"":"faded"),key:t},new Date(e.day).getDate(),function(e){if(e.td)return Object.keys(e.td).map((function(t){var a="dest-".concat(e.td[t]," ").concat(t);return r.a.createElement("div",{key:q.makeId(),className:a})}))}(e))})))}function ut(e){var t=e.trip,a=e.showDay;var n=function(){var e=t.destinations[0].startDate,a=t.destinations[t.destinations.length-1].endDate;return function(e,t,a){!function(e,t){var a=new Date(e);for(;a.getDay()>0;)a=new Date(a.getTime()-864e5),t.unshift({day:a})}(t,e);return function(e,t){var a=new Date(e);for(;a.getDay()<6;)a=new Date(a.getTime()+864e5),t.push({day:a});return t}(a,e)}(function(e,t,a){var n=new Date(e),r=[{day:n,td:{start:0}}];for(;n.getDate()!==new Date(t).getDate();)n=new Date(n.getTime()+864e5),r.push({day:n,td:""}),a.forEach((function(e){e.start.getDate()===n.getDate()&&e.start.getMonth()===n.getMonth()?r[r.length-1].td=Object(J.a)(Object(J.a)({},r[r.length-1].td),{},{start:e.idx}):e.start<n&&n.setHours(12)<e.end.setHours(11)?r[r.length-1].td=Object(J.a)(Object(J.a)({},r[r.length-1].td),{},{full:e.idx}):e.end.getDate()===n.getDate()&&e.end.getMonth()===n.getMonth()&&(r[r.length-1].td=Object(J.a)(Object(J.a)({},r[r.length-1].td),{},{end:e.idx}))}));return r}(e,a,t.destinations.map((function(e,t){return{start:new Date(e.startDate),end:new Date(e.endDate),idx:t}}))),e,a)}();return r.a.createElement("table",{className:"route-calendar"},r.a.createElement("thead",{className:"table-header"},r.a.createElement("tr",null,r.a.createElement("th",null,"S"),r.a.createElement("th",null,"M"),r.a.createElement("th",null,"T"),r.a.createElement("th",null,"W"),r.a.createElement("th",null,"T"),r.a.createElement("th",null,"F"),r.a.createElement("th",null,"S"))),r.a.createElement("tbody",null,function(e){var t=[];if(e.length%7!==0)return null;for(var n=e.length/7;n;)t.push(r.a.createElement(lt,{showDay:a,key:q.makeId(),dates:e.splice(0,7)})),n--;return t}(n)||"w"))}function pt(e){var t=e.destination,a=e.idx,n=e.isLast,i=e.updateDestinations,s=Object(Ge.a)({item:{type:$e,id:a},collect:function(e){return{isDragging:!!e.isDragging()}}}),o=Object(Be.a)(s,2),c=o[0].isDragging,l=o[1],u=Object(et.a)({accept:$e,drop:function(e,t){e.id!==a&&i(e.id,a)},collect:function(e){return{isOver:!!e.isOver()}}}),p=Object(Be.a)(u,2),m=p[0].isOver,d=p[1],h=m?"is-dragging":"",f=c?"on":"";return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"fire-ring ".concat(f)}),r.a.createElement("div",{ref:d,className:"time-line-area flex align-center"},r.a.createElement("div",{className:"route-time-line-context flex align-center "},r.a.createElement("div",{ref:l,className:"index-ball dest-".concat(a," flex align-center justify-center  ").concat(h," ")},r.a.createElement("p",null,a+1)),r.a.createElement("div",{className:"time-line-text"},r.a.createElement("p",null,t.name),r.a.createElement("p",null,q.calculateDays(t.startDate,t.endDate)-1," Nights")))),!n&&r.a.createElement("div",{className:"line"}))}function mt(e){var t=e.trip,a=e.updateDestinations;return r.a.createElement("div",{className:"route-time-line"},t.destinations.map((function(e,n){return r.a.createElement(pt,{key:q.makeId(),destination:e,idx:n,isLast:n+1===t.destinations.length,updateDestinations:a})})))}function dt(e){var t=e.trip,a=e.updateDestinations,n=e.showModal,i=e.addDestination,s=e.toggleChat,o=e.showDay,c=Object(et.a)({accept:$e,drop:function(e,t){a(e.id,-1)},collect:function(e){return{isOver:!!e.isOver()}}}),l=Object(Be.a)(c,2),u=(l[0].isOver,l[1]);return r.a.createElement("div",{className:"trip-route flex column"},r.a.createElement("div",{className:"members-preview flex justify-between align-center"},r.a.createElement("div",{className:"flex"},t.members.map((function(e,t){return r.a.createElement(ot,{key:t,member:e})}))),r.a.createElement("button",{className:"ustyled-button add-user-btn",onClick:function(){return n("add-member",t._id)}},r.a.createElement("i",{className:"fas fa-user-plus "}))),r.a.createElement(ut,{trip:t,showDay:o}),r.a.createElement("div",{className:"all-destinations-area"},r.a.createElement("div",{className:"trip-bar-icons trip-bar-destinations-icons flex justify-between"},r.a.createElement(ct,{addDestination:i}),r.a.createElement("i",{ref:u,className:"fas fa-trash "})),r.a.createElement(mt,{trip:t,updateDestinations:a})),r.a.createElement("div",{className:"trip-bar-icons flex justify-between flex1 align-end"},r.a.createElement("img",{onClick:function(){return n("trip-reviews")},className:"reviews-btn",src:"https://res.cloudinary.com/idanrozen/image/upload/v1601286406/6719970451595452853_wdwgqc.svg",alt:""}),r.a.createElement("i",{className:"fas fa-comments",onClick:s})))}var ht=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={msg:{from:e.props.loggedInUser?e.props.loggedInUser.username:"Traveler",txt:""},msgs:[],isTyping:""},e.loadHistory=function(t){e.setState({msgs:t||[]})},e.addMsg=function(t){e.setState((function(e){return{msgs:[].concat(Object(Q.a)(e.msgs),[t])}}))},e.sendMsg=function(t){t.preventDefault(),Je.emit("chat newMsg",e.state.msg),Je.emit("stopTyping","");var a=e.props.loggedInUser?e.props.loggedInUser.username:"Traveler";e.setState({msg:{from:a,txt:""}})},e.userTyping=function(t){e.setState({isTyping:t})},e.msgHandleChange=function(t){var a=t.target,n=a.name,r=a.value;if(r.trim().length>0){var i=e.props.loggedInUser?e.props.loggedInUser.username:"Traveler";Je.emit("user typing",i)}else Je.emit("stopTyping","");e.setState((function(e){return{msg:Object(J.a)(Object(J.a)({},e.msg),{},Object(Y.a)({},n,r))}}))},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){Je.on("chat addMsg",this.addMsg),Je.on("isTyping",this.userTyping),Je.on("notTyping",this.userTyping)}},{key:"componentWillUnmount",value:function(){Je.off("chat addMsg",this.addMsg),Je.off("isTyping",this.userTyping),Je.off("notTyping",this.userTyping),Je.terminate()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"chat-container flex column  ".concat(this.props.chatOpen?"open":"")},r.a.createElement("div",{className:"chat-header styled-header"},this.props.trip.destinations[0].name," Chat"),r.a.createElement("ul",{className:"chat-history"},this.state.msgs.map((function(t,a){return r.a.createElement("li",{key:a},r.a.createElement("div",{className:"message-data"},e.props.loggedInUser?e.props.loggedInUser.username===t.from?"Me":t.from:"Traveler"===t.from?"Traveler":t.from),r.a.createElement("div",{className:"message"},t.txt))}))),this.props.loggedInUser?this.state.isTyping&&this.state.isTyping!==this.props.loggedInUser.username?r.a.createElement("p",null,this.state.isTyping," is Typing"):"":this.state.isTyping&&!this.state.msg.txt.trim().length?r.a.createElement("p",null,this.state.isTyping," is Typing"):"",r.a.createElement("form",{className:"chat-send flex align-center",onSubmit:this.sendMsg},r.a.createElement("input",{type:"text",value:this.state.msg.txt,onChange:this.msgHandleChange,name:"txt",autoComplete:"off",placeholder:"New message"}),r.a.createElement("button",null,r.a.createElement("i",{className:"far fa-paper-plane"}))))}}]),a}(n.Component),ft=Object(m.b)((function(e){return{loggedInUser:e.userReducer.loggedInUser}}),{})(ht),vt=a(62);console.log("process.env.API_KEY:",Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).API_KEY);var gt=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={bounds:"",markers:[],selectedPlace:"",activeMarker:{},showingInfoWindow:!1},e.onMarkerClick=function(t,a,n){return e.setState({selectedPlace:t,activeMarker:a,showingInfoWindow:!0})},e.onMapClicked=function(t){e.state.showingInfoWindow&&e.setState({showingInfoWindow:!1,activeMarker:null})},e.getMarkers=function(){return e.state.markers.map((function(t,a){return r.a.createElement(vt.Marker,{key:q.makeId(),onClick:e.onMarkerClick,title:t.name,name:t.at||"",position:t.location,icon:e.state.imgs[a]})}))},e.containerStyle={width:"100%",height:"300px"},e}return Object(l.a)(a,[{key:"initiateMarkerABounds",value:function(){for(var e=[],t=new this.props.google.maps.LatLngBounds,a=0;a<this.props.markers.length;a++)this.props.markers[a].location&&this.props.markers[a].location.lng&&(t.extend(new this.props.google.maps.LatLng(this.props.markers[a].location)),e.push(this.props.markers[a]));return{markers:e,bounds:t}}},{key:"componentDidMount",value:function(){var e=this.initiateMarkerABounds(),t=e.markers,a=e.bounds,n="https://res.cloudinary.com/roidinary/image/upload/c_scale,w_40/v1601311538/",r=["".concat(n,"location1_xebwou.png"),"".concat(n,"location2_lxtqsq.png"),"".concat(n,"location3_zly9ql.png"),"".concat(n,"location4_venppr.png"),"".concat(n,"location5_xervod.png"),"".concat(n,"location6_fql1xk.png")];this.setState({bounds:a,markers:t,imgs:r})}},{key:"componentDidUpdate",value:function(e,t){if(this.props.markers!==e.markers){var a=this.initiateMarkerABounds(),n=a.markers,r=a.bounds;n.length>1&&this.state.map?this.state.map.fitBounds(r):this.state.map&&n[0]&&n[0].location&&n[0].location.lat&&(this.state.map.panTo(this.props.markers[0].location),this.state.map.setZoom(10)),this.setState({markers:n})}}},{key:"render",value:function(){var e=this;return r.a.createElement(vt.Map,{google:this.props.google,containerStyle:this.containerStyle,zoom:10,onClick:this.onMapClicked,onReady:function(t,a){e.state.markers.length>1?a.fitBounds(e.state.bounds):e.state.markers[0]&&a.panTo(e.state.markers[0].location),e.setState({map:a})},styles:[{featureType:"all",elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#333333"},{lightness:40}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#ffffff"},{lightness:16}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#fefefe"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#fefefe"},{lightness:17},{weight:1.2}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#f5f5f5"},{lightness:20}]},{featureType:"landscape",elementType:"geometry.fill",stylers:[{color:"#d5d5d5"}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{color:"#7574c0"},{saturation:"-37"},{lightness:"75"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#f5f5f5"},{lightness:21}]},{featureType:"poi.business",elementType:"geometry.fill",stylers:[{color:"#7574c0"},{saturation:"-2"},{lightness:"53"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#dedede"},{lightness:21}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#7574c0"},{lightness:"69"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#7574c0"},{lightness:"25"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#ffffff"},{lightness:29},{weight:.2}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{lightness:"38"},{color:"#000000"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:18}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:16}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#f2f2f2"},{lightness:19}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#e9e9e9"},{lightness:17}]}]},this.state.markers[0]&&this.getMarkers(),r.a.createElement(vt.InfoWindow,{marker:this.state.activeMarker,visible:this.state.showingInfoWindow},r.a.createElement("div",null,r.a.createElement("h1",null,this.state.selectedPlace.title),this.state.selectedPlace.name&&r.a.createElement("p",null,new Date(this.state.selectedPlace.name).getHours()+":"+new Date(this.state.selectedPlace.name).getMinutes()))))}}]),a}(r.a.Component),yt=Object(vt.GoogleApiWrapper)({apiKey:"AIzaSyA5YAKbctMWmj2etXv-KY7MSXDMGaWr0qs"})(gt),bt=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={chatOpen:!1,settingsOpen:!1,isSocketSetup:!1,markers:[],sideBar:!1},e.getMarkersOfDests=function(){return e.props.trip.destinations.map((function(e){return{location:e.location,name:e.name}}))},e.setDestsMarkers=function(){var t=e.getMarkersOfDests();e.setState({markers:t})},e.updateDestinations=function(){var t=Object(g.a)(v.a.mark((function t(a,n){var r,i,s,o,c,l,u,p,m,d,h;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object(Q.a)(e.props.trip.destinations),i=Object(Q.a)(e.props.trip.activities),s=q.calculateDays(r[a].startDate,r[a].endDate),o=r.splice(a,1)[0],c=864e5*(s-1),-1===n?(i=i.reduce((function(e,t,a){return t.destination===o.name||e.push(t),e}),[]),r.forEach((function(e,t){t>=a&&(e.startDate=e.startDate-c,e.endDate=e.endDate-c,i.forEach((function(t){t.destination===e.name&&(t.at-=c)})))}))):a>n?(l=q.calculateDays(e.props.trip.destinations[n].startDate,e.props.trip.destinations[a-1].endDate),u=864e5*(l-1),o.startDate=o.startDate-u,o.endDate=o.endDate-u,i.forEach((function(e){e.destination===o.name&&(e.at-=u)})),r.splice(n,0,o),r.forEach((function(e,t){t>n&&t<=a&&(e.startDate=e.startDate+c,e.endDate=e.endDate+c,i.forEach((function(t){t.destination===e.name&&(t.at+=c)})))}))):(p=q.calculateDays(e.props.trip.destinations[a+1].startDate,e.props.trip.destinations[n].endDate),m=864e5*(p-1),o.startDate=o.startDate+m,o.endDate=o.endDate+m,i.forEach((function(e){e.destination===o.name&&(e.at+=m)})),r.splice(n,0,o),r.forEach((function(e,t){t<n&&t>=a&&(e.startDate=e.startDate-c,e.endDate=e.endDate-c,i.forEach((function(t){t.destination===e.name&&(t.at-=c)})))}))),d=Object(J.a)(Object(J.a)({},e.props.trip),{},{activities:i,destinations:r}),t.next=9,e.props.addTrip(d);case 9:h=t.sent,Je.emit("tripToUpdate",h);case 11:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.updateTripAct=function(){var t=Object(g.a)(v.a.mark((function t(a){var n,r;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Object(J.a)(Object(J.a)({},e.props.trip),{},{activities:a}),t.next=3,e.props.addTrip(n);case 3:r=t.sent,Je.emit("tripToUpdate",r);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.toggleChat=function(){e.setState({chatOpen:!e.state.chatOpen})},e.toggleSettings=function(){e.setState({settingsOpen:!e.state.settingsOpen})},e.addDestination=function(){var t=Object(g.a)(v.a.mark((function t(a){var n,r,i,s;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Object(J.a)({},e.props.trip),r=n.destinations,a.startDate=r[r.length-1].endDate,a.endDate=a.startDate+864e5*(+a.days-1),a.id=q.makeId(),r.push(a),i=Object(J.a)(Object(J.a)({},e.props.trip),{},{destinations:r}),t.next=8,e.props.addTrip(i);case 8:s=t.sent,Je.emit("tripToUpdate",s);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.showDay=function(t){if(t.td){var a=e.props.trip.activities.reduce((function(e,a){return new Date(a.at).getDate()===t.day.getDate()&&e.push({name:a.name,location:a.location,at:a.at}),e}),[]);Ke.emit("markDay",t),e.setState({markers:a})}},e.openSideBar=function(){e.setState({sideBar:!e.state.sideBar})},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t,a,n,r,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,a=t.setTrip,n=t.loadTrip,t.addTrip,Je.setup(),r=this.props.match.params.id,Je.emit("enter trip",r),e.prev=4,e.next=7,n(r,!0);case 7:this.props.trip.originId&&this.props.showModal("alert-user",this.props.trip),"true"===this.props.match.params.openSignup&&this.props.showModal("signup",r),i=this.getMarkersOfDests(),this.setState({isSocketSetup:!0,markers:i}),e.next=15;break;case 13:e.prev=13,e.t0=e.catch(4);case 15:Je.on("tripUpdated",a);case 16:case"end":return e.stop()}}),e,this,[[4,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){var e=Object(g.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Je.off("tripUpdated",this.props.setTrip),this.props.loggedInUser||"guest"!==this.props.trip.createdBy.id){e.next=4;break}return e.next=4,this.props.removeTrip(this.props.trip._id);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(g.a)(v.a.mark((function e(t,a){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.trip!==this.props.trip){e.next=2;break}return e.abrupt("return");case 2:n=this.getMarkersOfDests(),this.setState({markers:n});case 4:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.trip,t=this.state.sideBar?"open-side-bar":"";return e&&e.destinations?r.a.createElement("div",{className:"trip-app  "},r.a.createElement(ae,null),r.a.createElement("div",{className:"trip-app-area flex "},r.a.createElement("button",{onClick:this.openSideBar,className:"side-bar-bars ".concat(t)},r.a.createElement("i",{className:"fas fa-bars "})),r.a.createElement("div",{className:"trip-side-bar flex column ".concat(t," ")},r.a.createElement(dt,{trip:e,addDestination:this.addDestination,updateDestinations:this.updateDestinations,showModal:this.props.showModal,toggleChat:this.toggleChat,showDay:this.showDay,openSideBar:this.openSideBar,setDestsMarkers:this.setDestsMarkers})),r.a.createElement("div",{className:"trip-app-main full"},this.state.markers[0]&&r.a.createElement(yt,{markers:this.state.markers}),r.a.createElement(st,{showMsg:this.props.showMsg,closeMsg:this.props.closeMsg,trip:e,updateTripAct:this.updateTripAct,showModal:this.props.showModal,closeModal:this.props.closeModal,setTrip:this.props.setTrip,openSideBar:this.openSideBar,setDestsMarkers:this.setDestsMarkers}))),this.state.isSocketSetup&&r.a.createElement(ft,{chatOpen:this.state.chatOpen,trip:e})):r.a.createElement("div",null,"Loading....")}}]),a}(n.Component),Et={loadTrip:S,removeTrip:function(e){return function(){var t=Object(g.a)(v.a.mark((function t(a){var n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x.remove(e);case 3:return n=t.sent,a({type:"REMOVE_TRIP",trip:n}),t.abrupt("return",n);case 8:t.prev=8,t.t0=t.catch(0);case 10:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},showModal:I,closeModal:A,addTrip:C,showMsg:$,closeMsg:Z,setTrip:function(e){return function(){var t=Object(g.a)(v.a.mark((function t(a){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:"SET_LOADER"}),a({type:"SET_TRIP",trip:e}),a({type:"CLOSE_LOADER"}),t.abrupt("return",e);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},wt=Object(m.b)((function(e){return{trip:e.tripReducer.currTrip,loggedInUser:e.userReducer.loggedInUser}}),Et)(Object(o.o)(bt)),Ot=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",null)}}]),a}(n.Component),Dt=Object(m.b)((function(e){return{}}),{})(Ot),jt=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={activitie:{name:"",at:"",time:"",labels:["relax"],duration:"",notes:"",price:"",destination:"",id:null},minTime:"",maxTime:""},e.handleTime=function(t){var a=6e4*t.getTimezoneOffset(),n=new Date(t-a).toISOString().slice(0,-1);e.setState({activitie:Object(J.a)(Object(J.a)({},e.state.activitie),{},{at:n})})},e.handleChange=function(t){var a=t.target,n=a.name,r=a.value;"checkbox"===a.type?e.setState(Object(Y.a)({},n,a.checked)):e.setState({activitie:Object(J.a)(Object(J.a)({},e.state.activitie),{},Object(Y.a)({},n,r))})},e.onSaveAct=function(t){t.preventDefault();var a=e.props.props,n=a.saveAct,r=a.isOccTimeSlot,i=e.state.activitie;if(i.at){var s=new Date(i.at);i.at=s.getTime(),r(i)||(i.price=+i.price||0,i.duration=!+i.duration||+i.duration<=1?1:+i.duration,i.price={amount:i.price,currency:"$"},n(e.state.activitie))}},e.getValidTime=function(){return new Date(e.state.activitie.at)},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t,a,n,r,i,s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.props,a=t.act,n=t.destinations,a?(s=n.findIndex((function(e){return e.name===a.destination})),r=q.getIsoTime(n[s].startDate),i=q.getIsoTime(n[s].endDate),this.setState({activitie:Object(J.a)(Object(J.a)({},a),{},{name:a.name,price:a.price.amount,at:q.getIsoTime(a.at),destination:a.destination}),minTime:r,maxTime:i})):(r=q.getIsoTime(n[0].startDate),i=q.getIsoTime(n[n.length-1].endDate),this.setState({activitie:Object(J.a)(Object(J.a)({},this.state.activitie),{},{destination:n[0].name}),minTime:r,maxTime:i}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e,t){var a=this.props.props.destinations,n=this.state.activitie.destination;if(t.activitie.destination!==n&&n&&!this.state.activitie.id){var r=a.findIndex((function(e){return e.name===n})),i=q.getIsoTime(a[r].startDate),s=q.getIsoTime(a[r].endDate);this.setState({minTime:i,maxTime:s})}}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.activitie,i=a.minTime,s=a.maxTime;if(!n)return r.a.createElement("div",null,"Loading");var o,c=this.props.props.destinations,l=new Date(i),u=new Date(s),p=l.setHours(7,0),m=(o=n.at?new Date(n.at):new Date(p)).setHours(7,0),d=o.setHours(23,59),h=new Date(m),f=new Date(d);return r.a.createElement("form",{className:"edit-activity-form flex column",onSubmit:this.onSaveAct},r.a.createElement("input",{className:"styled-input",placeholder:"Enter activity Name",name:"name",id:"name",value:this.state.activitie.name,onChange:this.handleChange}),!n.id&&r.a.createElement("div",null,r.a.createElement("i",{className:"fas fa-map-marker"}),r.a.createElement("select",{value:this.state.activitie.destination,placeholder:"destination",name:"destination",id:"dest-input",onChange:this.handleChange},c.map((function(e,t){return r.a.createElement("option",{key:q.makeId(),value:e.name},e.name)})))),r.a.createElement("div",{className:"flex"},r.a.createElement("i",{className:"far fa-clock"}),r.a.createElement("div",{className:"flex column"},r.a.createElement("label",{htmlFor:"start-time-activity-input"},"Time"),r.a.createElement(X.a,{minDate:l,maxDate:u,selected:this.getValidTime().getTime()||p,value:this.getValidTime().getTime()||p,minTime:h,maxTime:f,autoComplete:"off",className:"styled-input",showTimeSelect:!0,required:!0,showFullMonthYearPicker:!0,dateFormat:"Pp",onChange:function(e){return t.handleTime(e)}})),r.a.createElement("div",{className:"flex column justify-evenly align-baseline"},r.a.createElement("label",{htmlFor:"duration"},"Duration (Half hours)"),r.a.createElement("input",{className:"styled-input",placeholder:"duration",id:"duration",type:"number",name:"duration",value:this.state.activitie.duration,onChange:this.handleChange}))),r.a.createElement("textarea",{placeholder:"Add some notes",onChange:this.handleChange,name:"notes",id:"notes",value:this.state.activitie.notes}),r.a.createElement("div",{className:"flex"},r.a.createElement("i",{className:"fas fa-dollar-sign"}),r.a.createElement("input",(e={className:"styled-input",type:"number",placeholder:"price",name:"price",id:"price",onChange:this.handleChange},Object(Y.a)(e,"placeholder","price"),Object(Y.a)(e,"value",this.state.activitie.price),e))),r.a.createElement("button",{className:"styled-button",onClick:this.onSaveAct},"Save"))}}]),a}(n.Component),kt=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={activitie:{name:"",at:"",time:"",labels:"",duration:"",notes:"",price:"",currency:"",destination:"",id:null},minTime:"",maxTime:"",isInputOpen:!1},e.handleTime=function(t){var a=6e4*t.getTimezoneOffset(),n=new Date(t-a).toISOString().slice(0,-1);e.setState({activitie:Object(J.a)(Object(J.a)({},e.state.activitie),{},{at:n})})},e.handleChange=function(t){var a=t.target.name,n=t.target.value;e.setState({activitie:Object(J.a)(Object(J.a)({},e.state.activitie),{},Object(Y.a)({},a,n))})},e.handleContentEditable=function(t){var a=t.currentTarget.dataset.name,n=t.target.innerText;"price"===a?e.setState({activitie:Object(J.a)(Object(J.a)({},e.state.activitie),{},Object(Y.a)({},a,+n))}):e.setState({activitie:Object(J.a)(Object(J.a)({},e.state.activitie),{},Object(Y.a)({},a,n))})},e.onSaveAct=function(t){t.preventDefault();var a=e.props.props,n=a.saveAct,r=a.isOccTimeSlot,i=e.state.activitie,s=new Date(i.at);i.at=s.getTime(),i.duration?+i.duration&&(i.duration=+i.duration):i.duration=1,r(i)?e.props.showMsg({type:"input",msg:"You aleardy have plans for that date! please choose a different one."}):(i.price={amount:i.price,currency:"$"},n(e.state.activitie))},e.getValidTime=function(){return new Date(e.state.activitie.at)},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t,a,n,r,i,s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.props,a=t.act,n=t.destinations,s=n.findIndex((function(e){return e.name===a.destination})),r=q.getIsoTime(n[s].startDate),i=q.getIsoTime(n[s].endDate),this.setState({activitie:Object(J.a)(Object(J.a)({},a),{},{name:a.name,currency:a.price.currency,price:a.price.amount,at:q.getIsoTime(a.at),destination:a.destination,duration:a.duration}),minTime:r,maxTime:i});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=q.getTimeDayStr(new Date(this.state.activitie.at).getTime()),a=q.getTimeDayStr(new Date(this.state.activitie.at).getTime()+this.state.activitie.duration/2*60*60*1e3),n=this.state,i=n.activitie,s=n.minTime,o=n.maxTime;if(!i)return r.a.createElement("div",null,"Loading");var c,l=new Date(s),u=new Date(o),p=l.setHours(7,0),m=(c=i.at?new Date(i.at):new Date(p)).setHours(7,0),d=c.setHours(23,59),h=new Date(m),f=new Date(d);return r.a.createElement("form",{className:"preview-activity-form flex column"},r.a.createElement("h2",{contentEditable:!0,suppressContentEditableWarning:!0,"data-placeholder":"Enter activity name",spellCheck:"false",style:{direction:"ltr"},"data-name":"name",onBlur:this.handleContentEditable},this.state.activitie.name),r.a.createElement("div",{className:"flex"},r.a.createElement("small",null,r.a.createElement("i",{className:"fas fa-map-marker"})," ",this.state.activitie.destination),r.a.createElement("small",null,r.a.createElement("i",{className:"far fa-clock"}),"".concat(t,"-").concat(a)," ",r.a.createElement("i",{onClick:function(){e.setState({isInputOpen:!e.state.isInputOpen})},className:"fas fa-edit"}))),r.a.createElement(ae,null),r.a.createElement("div",{className:"flex time-container ".concat(this.state.isInputOpen?"openHeight":""," ")},r.a.createElement("div",{className:"flex column"},r.a.createElement("h4",null,"Beginning time:"),r.a.createElement(X.a,{minDate:l,maxDate:u,selected:this.getValidTime().getTime(),value:this.getValidTime().getTime()||p,minTime:h,maxTime:f,autoComplete:"off",className:"styled-input prev-date-picker date",showTimeSelect:!0,required:!0,dateFormat:"Pp",onChange:function(t){return e.handleTime(t)}})),r.a.createElement("div",{className:"flex column"},r.a.createElement("h4",null,"Duration (Half hours)"),r.a.createElement("input",{className:"styled-input",placeholder:"duration",id:"duration",type:"number",name:"duration",value:this.state.activitie.duration,onChange:this.handleChange}))),r.a.createElement("img",{src:this.props.props.act.imgUrl,alt:"https://teddytennis.com/cyprus/wp-content/uploads/sites/76/2017/11/placeholder.png"}),r.a.createElement("textarea",{placeholder:"Add some notes",onChange:this.handleChange,name:"notes",id:"notes",value:this.state.activitie.notes}),r.a.createElement("div",{className:"flex"},r.a.createElement("h4",null,"Price:"),r.a.createElement("p",null,this.state.activitie.currency),r.a.createElement("p",{contentEditable:!0,suppressContentEditableWarning:!0,"data-name":"price",onBlur:this.handleContentEditable},this.state.activitie.price)),r.a.createElement("button",{className:"styled-button",onClick:this.onSaveAct},"Save"))}}]),a}(n.Component),xt=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={reviewToAdd:{content:"",name:"",rating:null}},e.elInput=r.a.createRef(),e.onInputChange=function(t,a){e.setState({reviewToAdd:Object(J.a)(Object(J.a)({},e.state.reviewToAdd),{},Object(Y.a)({},a,t))})},e.onAddReview=function(t){t.preventDefault(),e.state.reviewToAdd.rating?(e.props.addReview(e.state.reviewToAdd),e.setState({reviewToAdd:{content:"",name:"",rating:null}})):e.props.showMsg({msg:"You must rate this trip first",type:"input"})},e.setRating=function(t){e.setState({reviewToAdd:Object(J.a)(Object(J.a)({},e.state.reviewToAdd),{},{rating:t})})},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.elInput.current.focus()}},{key:"render",value:function(){var e=this,t=this.props.isReviewOpen?"open":"",a=this.state.reviewToAdd.rating;return r.a.createElement("div",{className:"review-modal flex ".concat(t)},r.a.createElement("form",{className:"flex column ",onSubmit:this.onAddReview},r.a.createElement(ae,null),r.a.createElement("div",{className:"flex"},r.a.createElement("input",{className:"styled-input",placeholder:"Enter your name",type:"text",name:"name",required:!0,onChange:function(t){e.onInputChange(t.target.value,t.target.name)}}),r.a.createElement("div",{className:"stars-rate flex"},r.a.createElement("i",{className:"fas fa-star star-5 ".concat(5===a?"active":""),onClick:function(){e.setRating(5)}}),r.a.createElement("i",{className:"fas fa-star star-4 ".concat(a>=4?"active":""),onClick:function(){e.setRating(4)}}),r.a.createElement("i",{className:"fas fa-star star-3 ".concat(a>=3?"active":""),onClick:function(){e.setRating(3)}}),r.a.createElement("i",{className:"fas fa-star star-2 ".concat(a>=2?"active":""),onClick:function(){e.setRating(2)}}),r.a.createElement("i",{className:"fas fa-star star-1 ".concat(a>=1?"active":""),onClick:function(){e.setRating(1)}}))),r.a.createElement(ae,null),r.a.createElement("textarea",{id:"content",required:!0,name:"content",placeholder:"Enter your review here",ref:this.elInput,onChange:function(t){e.onInputChange(t.target.value,t.target.name)}}),r.a.createElement("button",{className:"styled-button"},"Save")))}}]),a}(r.a.Component),Tt=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={text:e.props.text,isLongTxtShown:!1},e.onReadMore=function(){e.setState({isLongTxtShown:!e.state.isLongTxtShown})},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.state.text,t=this.state.isLongTxtShown;return r.a.createElement("p",null,e.length<100||t&&e.length>100?e:e.substring(0,100)+" . . .",e.length>100&&r.a.createElement("button",{className:" styled-button expend-description",onClick:this.onReadMore},this.state.isLongTxtShown?"Less":"More"))}}]),a}(r.a.Component);function Nt(e){var t=e.review;var a="".concat(new Date(t.createdAt).getDate(),"/").concat(new Date(t.createdAt).getMonth()+1,"/").concat(new Date(t.createdAt).getFullYear());return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"review-details flex justify-between "},r.a.createElement("h3",null,t.name||"Traveler"),r.a.createElement("div",{className:"flex column"},r.a.createElement("div",null,function(){for(var e=[],a=0;a<t.rating;a++)e.push(r.a.createElement("img",{className:"rating-star",key:q.makeId(),src:"https://res.cloudinary.com/idanrozen/image/upload/v1600689776/450716_preview_uyyiz1.png",alt:""}));for(var n=0;n<5-t.rating;n++)e.push(r.a.createElement("img",{className:"rating-star",key:q.makeId(),src:"https://res.cloudinary.com/idanrozen/image/upload/v1600690459/450716_preview1_pvoieq.png",alt:""}));return e}()," "),r.a.createElement("p",null,a))),t.content&&r.a.createElement(Tt,{text:t.content}))}function St(e){var t=e.reviews;return r.a.createElement("ul",{className:"review-list flex column container"},t&&t.length?t.map((function(e,t){return r.a.createElement("li",{className:"review flex column",key:t},r.a.createElement(Nt,{key:e._id,review:e}))})):"No reviews have been written for this trip yet")}var Mt=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={isReviewOpen:!1},e.onToggleExpend=function(){e.setState({isReviewOpen:!e.state.isReviewOpen})},e.addReview=function(){var t=Object(g.a)(v.a.mark((function t(a){var n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props.trip.originId?e.props.trip.originId:e.props.trip._id,a.trip=n,t.next=4,we.addReview(a);case 4:return t.next=6,e.props.loadReviews({tripId:n});case 6:e.onToggleExpend();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.trip.originId?this.props.trip.originId:this.props.trip._id,e.prev=1,e.next=4,this.props.loadReviews({tripId:t});case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.props.trip?r.a.createElement("div",{className:"reviews-page"},r.a.createElement(St,{reviews:this.props.reviews}),r.a.createElement("div",{className:"flex reviews-btns-container"},r.a.createElement("button",{className:"review-btns styled-button",onClick:this.onToggleExpend},this.state.isReviewOpen?"Close":" Add Review")),r.a.createElement(xt,{addReview:this.addReview,msg:this.props.msg,showMsg:this.props.showMsg,closeMsg:this.props.closeMsg,isReviewOpen:this.state.isReviewOpen})):r.a.createElement("p",null," Loading . . .")}}]),a}(n.Component),Ct={addReview:we.addReview,loadReviews:we.loadReviews},It=Object(m.b)((function(e){return{reviews:e.reviewReducer.reviews,trip:e.tripReducer.currTrip}}),Ct)(Object(o.o)(Mt)),At=a(138),Rt=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={value:"",copied:!1},e.handleInput=function(t,a){e.setState({emailToSend:Object(J.a)(Object(J.a)({},e.state.emailToSend),{},Object(Y.a)({},a,t))})},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.setState({value:"http://localhost:3000/#/trip/".concat(this.props.props,"/triproute/true")})}},{key:"onAddMember",value:function(e,t){e.preventDefault(),this.props.closeModal()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"flex column share-trip"},r.a.createElement("h3",null,"Share this link with your trip partners and start planning together!"),r.a.createElement("img",{src:"https://thumbs.dreamstime.com/b/group-young-people-friends-celebrating-successful-hiking-expedition-group-young-people-friends-celebrating-successful-hiking-123552345.jpg",alt:""}),r.a.createElement("input",{disabled:!0,className:"styled-input",value:this.state.value,onChange:function(t){var a=t.target.value;return e.setState({value:a,copied:!1})}}),r.a.createElement(At.CopyToClipboard,{text:this.state.value,onCopy:function(){return e.setState({copied:!0})}},r.a.createElement("button",{className:"styled-button"},"Copy and share")),this.state.copied?r.a.createElement("span",{style:{color:"orange"}},"Copied!"):null)}}]),a}(n.Component),_t=document.createElement("div");function Lt(e){var t=e.props,a="guest"===t.modal.props.createdBy.id?"Be aware your Changes would not be saved, in case you would like  to save the changes and even add friends to the plan, go back to the home page, sign up and choose a template trip again!":"your trip will be saved in Trips under the name: "+t.modal.props.tripName;return r.a.createElement("p",{style:{padding:"15px"}},a)}document.body.appendChild(_t);var Ht=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={isShown:!1,msg:"",type:""},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("p",null,"Are you sure you want to delete?"),r.a.createElement("div",{className:"flex notification-btns"},r.a.createElement("button",{className:"styled-button",onClick:function(){return e.props.props.removeAct(e.props.props.actId)}},"Delete"),r.a.createElement("button",{className:"styled-button",onClick:function(){return e.props.closeModal()}},"Cancel")))}}]),a}(n.Component),Ut=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={dynamicCmp:"",nameToDisplay:""},e.handleClick=function(t){e.props.showModal(t)},e.checkKey=function(t){"Escape"===t.key&&e.closeModal()},e.closeModal=function(){e.props.closeModal()},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(e,t){var a=this.props.modal.cmp;if(e.modal.cmp!==a){var n="",i="";switch(a){case"login":n=r.a.createElement(ze,{page:!0,handleClick:this.handleClick}),i="Please Login";break;case"signup":var s=this.props.modal.props;n=r.a.createElement(ze,{page:!1,handleClick:this.handleClick,tripId:s}),i="Please Sign Up";break;case"editActivity":n=r.a.createElement(jt,{props:this.props.modal.props}),i="Edit activity";break;case"activityDetails":n=r.a.createElement(kt,{props:this.props.modal.props,showMsg:this.props.showMsg,closeMsg:this.props.closeMsg}),i="Activity Details";break;case"removeActivity":n=r.a.createElement(Ht,{props:this.props.modal.props,closeModal:this.props.closeModal}),i="Delete Activity";break;case"add-review":n=r.a.createElement(xt,{props:this.props.modal.props.addReview,showMsg:this.props.showMsg,closeMsg:this.props.closeMsg,closeModal:this.closeModal}),i="Add Review";break;case"add-member":n=r.a.createElement(Rt,{props:this.props.modal.props,closeModal:this.closeModal}),i="Add Member";break;case"trip-reviews":n=r.a.createElement(It,{showMsg:this.props.showMsg,msg:this.props.msg,closeMsg:this.props.closeMsg,closeModal:this.closeModal}),i="Reviews";break;case"alert-user":n=r.a.createElement(Lt,{props:this.props,closeModal:this.closeModal}),i="Welcome!";break;default:n=r.a.createElement("div",null,"proplem loading modal")}this.setState({dynamicCmp:n,nameToDisplay:i})}}},{key:"render",value:function(){return r.a.createElement("div",{className:"modal-screen flex align-center justify-center ".concat(this.props.modal.isShown?"":"hide"),onKeyDown:this.checkKey,onMouseDown:this.closeModal},r.a.createElement("div",{className:"modal-container ",onMouseDown:function(e){return e.stopPropagation()}},r.a.createElement("div",{className:"modal-header flex align-center justify-center styled-header"},r.a.createElement("p",null,this.state.nameToDisplay),r.a.createElement("button",{onClick:this.closeModal},"X")),r.a.createElement("div",{className:"modal-content"},this.state.dynamicCmp)))}}]),a}(r.a.Component),Bt={closeModal:A,showModal:I,showMsg:$,closeMsg:Z},Wt=Object(m.b)((function(e){return{modal:e.modalReducer,msg:e.msgReducer.msg}}),Bt)(Object(o.o)(Ut)),Pt=(a(284),function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return this.props.loader?r.a.createElement("div",{className:"positioning-container"},r.a.createElement("div",{className:"spinning-container"},r.a.createElement("span",null,"LOADING"),r.a.createElement("div",{className:"airplane-container"},r.a.createElement("img",{className:"plane",src:"https://res.cloudinary.com/roidinary/image/upload/v1600624566/Asset_dwekpj.png",alt:"Loading"})))):r.a.createElement(r.a.Fragment,null)}}]),a}(r.a.Component)),Ft=Object(m.b)((function(e){return{loader:e.modalReducer.loaderOn}}),{})(Pt);function Yt(){return r.a.createElement("div",{className:"footer flex align-center justify-center"},"TrollyRights 2022 \xa9")}function Jt(){return r.a.createElement("div",{style:{position:"relative"},className:"App "},r.a.createElement(P,null),r.a.createElement("main",null,r.a.createElement(Wt,null),r.a.createElement(Ft,null),r.a.createElement(o.g,null,r.a.createElement(o.d,{component:ze,path:"/lognsignup"}),r.a.createElement(o.d,{component:wt,path:"/trip/:id/:triproute/:openSignup?"}),r.a.createElement(o.d,{component:Dt,path:"/user/:id"}),r.a.createElement(o.d,{component:Ue,path:"/trip"}),r.a.createElement(o.d,{component:F,path:"/about"}),r.a.createElement(o.d,{exact:!0,component:Ce,path:"/"}))),r.a.createElement(Yt,null))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Qt=a(39),qt=a(139),zt={isShown:!1,props:null,cmp:null,msg:null,loaderOn:!1};var Vt={isShown:!1,type:"",msg:""};var Kt={reviews:[],selectedReview:null};var Gt={trips:[],currTrip:null};var Xt=null;sessionStorage.user&&(Xt=JSON.parse(sessionStorage.user));var $t={users:[],loggedInUser:Xt};var Zt=Object(Qt.c)({tripReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TRIPS":return Object(J.a)(Object(J.a)({},e),{},{trips:t.trips});case"EDIT_TRIP":return Object(J.a)(Object(J.a)({},e),{},{currTrip:Object(J.a)({},t.trip),trips:e.trips.map((function(e){return t.trip._id===e._id?t.trip:e}))});case"REMOVE_TRIP":return Object(J.a)(Object(J.a)({},e),{},{currTrip:null,trips:e.trips.map((function(e){return t.trip._id===!e._id?t.trip:e}))});case"SET_TRIP":return Object(J.a)(Object(J.a)({},e),{},{currTrip:Object(J.a)({},t.trip)});default:return e}},userReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$t,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return{users:Object(Q.a)(e.users),loggedInUser:t.user};case"SET_USERS":return Object(J.a)(Object(J.a)({},e),{},{users:t.users});default:return e}},modalReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MODAL":return{isShown:!0,props:t.props,cmp:t.cmp};case"CLOSE_MODAL":return{isShown:!1,props:null,cmp:null};case"LOGIN_PROBLEML":return Object(J.a)(Object(J.a)({},e),{},{msg:"wrong email or password"});case"SET_LOADER":return{loaderOn:!0};case"CLOSE_LOADER":return{loaderOn:!1};default:return e}},reviewReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kt,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"SET_REVIEWS":return Object(J.a)(Object(J.a)({},e),{},{reviews:t.reviews});case"REVIEW_ADD":return Object(J.a)(Object(J.a)({},e),{},{reviews:[].concat(Object(Q.a)(e.reviews),[t.review])});case"REVIEW_UPDATE":return Object(J.a)(Object(J.a)({},e),{},{reviews:e.reviews.map((function(e){return e._id===t.review._id?t.review:e}))});default:return e}},msgReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MSG":return{isShown:!0,msg:t.msg.msg,type:t.msg.type};case"CLOSE_MSG":return{isShown:!1,type:"",msg:""};default:return e}}}),ea=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Qt.d,ta=Object(Qt.e)(Zt,ea(Object(Qt.a)(qt.a))),aa=a(300),na=a(140);s.a.render(r.a.createElement(m.a,{store:ta},r.a.createElement(aa.a,{backend:na.a},r.a.createElement(d.HashRouter,null,r.a.createElement(Jt,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[142,1,2]]]);
//# sourceMappingURL=main.11836b48.chunk.js.map